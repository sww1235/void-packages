# Template file for 'spin2cpp'
pkgname=spin2cpp
version=5.0.3
revision=1
build_style=gnu-makefile
hostmakedepends="bison"
short_desc="Converting languages for the Parallax Inc. Propeller 1 and 2"
maintainer="Jürgen Buchmüller <pullmoll@t-online.de>"
license="MIT"
homepage="https://github.com/totalspectrum/spin2cpp/"
distfiles="https://github.com/totalspectrum/${pkgname}/archive/v${version}.tar.gz"
checksum=d19d4c9230e35e34df6d689634ce49c6752f386a77171ca3ae01aa1700a7b549

CFLAGS="-I. -I./build -DFLEXSPIN_BUILD -fcommon"

do_check() {
	make CFLAGS="$CFLAGS" ${makejobs} test || true # some tests fail
}

do_install() {
	for f in flexcc flexspin spin2cpp; do
		vbin build/$f
	done
	vmkdir usr/share/${pkgname}
	vcopy doc usr/share/${pkgname}
	vlicense COPYING
}
